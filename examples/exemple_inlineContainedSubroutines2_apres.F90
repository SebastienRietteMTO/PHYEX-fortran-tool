SUBROUTINE FOO

USE MODD, ONLY: ICEPt

REAL, DIMENSION(KSIZE1) :: Z1, Z2
REAL, DIMENSION(KSIZE1, 2) :: Z3, Z4
REAL, DIMENSION(-5:KSIZE1) :: Z5
TYPE(ICEPt) :: ICEP
TYPE(ICEPt), DIMENSION(5) :: ICEPARRAY

print*, Z1(:)
print*, Z1(1)
print*, D%G
print*, D%G%H

!Call INC1
Z1(1)=Z1(2)
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(1:KSIZE2)=5.
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(2:KSIZE2)=Z1(2:KSIZE2)

  Z2(1)=Z2(2)
  Z2(1:KSIZE2)=Z2(1:KSIZE2)
  Z2(1:KSIZE2)=Z2(1:KSIZE2)
  Z2(1:KSIZE2)=5.
  Z2(1:KSIZE2)=Z2(1:KSIZE2)
  Z2(2:KSIZE2)=Z2(2:KSIZE2)

  Z3(1, 1)=Z3(2, 1)
  Z3(1:KSIZE2, 1)=Z3(1:KSIZE2, 1)
  Z3(1:KSIZE2, 1)=Z3(1:KSIZE2, 1)
  Z3(1:KSIZE2, 1)=5.
  Z3(1:KSIZE2, 1)=Z3(1:KSIZE2, 1)
  Z3(2:KSIZE2, 1)=Z3(2:KSIZE2, 1)

  Z4(1, 1)=Z4(2, 1)
  Z4(1:KSIZE2, 1)=Z4(1:KSIZE2, 1)
  Z4(1:KSIZE2, 1)=Z4(1:KSIPE2, 1)
  Z4(1:KSIZE2, 1)=5.
  Z4(1:KSIZE2, 1)=Z4(1:KSIZE2, 1)
  Z4(2:KSIZE2, 1)=Z4(2:KSIZE2, 1)

  Z1(1)=Z1(2)
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(1:KSIZE2)=Z1(1:KSIPE2)
  Z1(1:KSIZE2)=5.
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(2:KSIZE2)=Z1(2:KSIZE2)

  ICEP%T(1+LBOUND(ICEP%T, 1)-1)=ICEP%T(2+LBOUND(ICEP%T, 1)-1)
  ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)
  ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIPE2+LBOUND(ICEP%T, 1)-1)
  ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=5.
  ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)
  ICEP%T(2+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=ICEP%T(2+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)

  print*, 1, Z1(1)



!Call INC1 with keyword keys
Z1(1)=Z1(2)
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(1:KSIZE2)=5.
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(2:KSIZE2)=Z1(2:KSIZE2)

  Z2(1)=Z2(2)
  Z2(1:KSIZE2)=Z2(1:KSIZE2)
  Z2(1:KSIZE2)=Z2(1:KSIZE2)
  Z2(1:KSIZE2)=5.
  Z2(1:KSIZE2)=Z2(1:KSIZE2)
  Z2(2:KSIZE2)=Z2(2:KSIZE2)

  Z3(1, 1)=Z3(2, 1)
  Z3(1:KSIZE2, 1)=Z3(1:KSIZE2, 1)
  Z3(1:KSIZE2, 1)=Z3(1:KSIZE2, 1)
  Z3(1:KSIZE2, 1)=5.
  Z3(1:KSIZE2, 1)=Z3(1:KSIZE2, 1)
  Z3(2:KSIZE2, 1)=Z3(2:KSIZE2, 1)

  Z4(1, 1)=Z4(2, 1)
  Z4(1:KSIZE2, 1)=Z4(1:KSIZE2, 1)
  Z4(1:KSIZE2, 1)=Z4(1:KSIPE2, 1)
  Z4(1:KSIZE2, 1)=5.
  Z4(1:KSIZE2, 1)=Z4(1:KSIZE2, 1)
  Z4(2:KSIZE2, 1)=Z4(2:KSIZE2, 1)

  Z1(1)=Z1(2)
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(1:KSIZE2)=Z1(1:KSIPE2)
  Z1(1:KSIZE2)=5.
  Z1(1:KSIZE2)=Z1(1:KSIZE2)
  Z1(2:KSIZE2)=Z1(2:KSIZE2)

  ICEP%T(1+LBOUND(ICEP%T, 1)-1)=ICEP%T(2+LBOUND(ICEP%T, 1)-1)
  ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)
  ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIPE2+LBOUND(ICEP%T, 1)-1)
  ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=5.
  ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=ICEP%T(1+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)
  ICEP%T(2+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)=ICEP%T(2+LBOUND(ICEP%T, 1)-1:KSIZE2+LBOUND(ICEP%T, 1)-1)

  print*, 1, Z1(1)



!Call INC2 with arg name inversion
Z1(1:KSIZE2)=Z2(1:KSIZE2)

Z1(1:KSIZE2)=Z1(1:KSIZE2)


!Call INC3 with optional arg
IF(.TRUE.) Z1(1:KSIZE2)=Z1(1:KSIZE2)+1  
!dd

IF(.TRUE.) Z1(1:KSIZE2)=Z1(1:KSIZE2)+1  
!dd

IF(.TRUE.) Z2(1:KSIZE2)=Z2(1:KSIZE2)+2
!dd


!Call INC4 with structure
print*, A%B%D%T(:)
  print*, ICEPARRAY(1)%D%T(:)
  print*, ICEPARRAY(4)%D%T(:)


!Call INC5 for offset
Z1(1+1-5)=Z1(2+1-5)
  Z1(5+1-5:KSIZE2+1-5)=Z1(5+1-5:KSIZE2+1-5)
  Z1(1+1-5:KSIZE2+1-5)=Z1(1+1-5:KSIZE2+1-5)
  Z1(5+1-5:KSIZE2+1-5)=5.
  Z1(5+1-5:KSIZE2+1-5)=Z1(5+1-5:KSIZE2+1-5)
  Z1(2+1-5:KSIZE2+1-5)=Z1(2+1-5:KSIZE2+1-5)

  Z1(1+3-5)=Z1(2+3-5)
  Z1(5+3-5:KSIZE2+3-5)=Z1(5+3-5:KSIZE2+3-5)
  Z1(1+3-5:KSIZE2+3-5)=Z1(1+3-5:KSIZE2+3-5)
  Z1(5+3-5:KSIZE2+3-5)=5.
  Z1(5+3-5:KSIZE2+3-5)=Z1(5+3-5:KSIZE2+3-5)
  Z1(2+3-5:KSIZE2+3-5)=Z1(2+3-5:KSIZE2+3-5)

  Z1(1+3-5)=Z1(2+3-5)
  Z1(5+3-5:KSIZE2+3-5)=Z1(5+3-5:KSIZE2+3-5)
  Z1(1+3-5:KSIZE2+3-5)=Z1(1+3-5:KSIZE2+3-5)
  Z1(5+3-5:KSIZE2+3-5)=5.
  Z1(5+3-5:KSIZE2+3-5)=Z1(5+3-5:KSIZE2+3-5)
  Z1(2+3-5:KSIZE2+3-5)=Z1(2+3-5:KSIZE2+3-5)

Z5(1+(-5)-5)=Z5(2+(-5)-5)
  Z5(5+(-5)-5:KSIZE2+(-5)-5)=Z5(5+(-5)-5:KSIZE2+(-5)-5)
  Z5(1+(-5)-5:KSIZE2+(-5)-5)=Z5(1+(-5)-5:KSIZE2+(-5)-5)
  Z5(5+(-5)-5:KSIZE2+(-5)-5)=5.
  Z5(5+(-5)-5:KSIZE2+(-5)-5)=Z5(5+(-5)-5:KSIZE2+(-5)-5)
  Z5(2+(-5)-5:KSIZE2+(-5)-5)=Z5(2+(-5)-5:KSIZE2+(-5)-5)

  Z5(1+3-5)=Z5(2+3-5)
  Z5(5+3-5:KSIZE2+3-5)=Z5(5+3-5:KSIZE2+3-5)
  Z5(1+3-5:KSIZE2+3-5)=Z5(1+3-5:KSIZE2+3-5)
  Z5(5+3-5:KSIZE2+3-5)=5.
  Z5(5+3-5:KSIZE2+3-5)=Z5(5+3-5:KSIZE2+3-5)
  Z5(2+3-5:KSIZE2+3-5)=Z5(2+3-5:KSIZE2+3-5)

  Z5(1+3-5)=Z5(2+3-5)
  Z5(5+3-5:KSIZE2+3-5)=Z5(5+3-5:KSIZE2+3-5)
  Z5(1+3-5:KSIZE2+3-5)=Z5(1+3-5:KSIZE2+3-5)
  Z5(5+3-5:KSIZE2+3-5)=5.
  Z5(5+3-5:KSIZE2+3-5)=Z5(5+3-5:KSIZE2+3-5)
  Z5(2+3-5:KSIZE2+3-5)=Z5(2+3-5:KSIZE2+3-5)


!CALL INC6 for 2D arrays
Z3(1:KSIZE, 1)=Z3(1:KSIZE, 2)


CONTAINS

END SUBROUTINE FOO
